@model WelcomeMessage

@using Microsoft.AspNetCore.Mvc.Localization
@inject IHtmlLocalizer<PortfolioCV.SharedResource> SharedLocalizer

@{
    ViewData["Title"] = SharedLocalizer["Home"];
    
    // Fallback values if DB is empty
    var title = Model?.Title ?? "Web Geliştirici & Tasarımcı";
    var subtitle = Model?.Subtitle ?? "Mekatronik Mühendisi, Full Stack Developer, Freelancer";
    var desc = Model?.Description ?? "Merhaba! Yazılım geliştirme alanında uzmanlaşmış bir profesyonelim. Modern web teknolojileri ile kullanıcı dostu ve performanslı çözümler üretiyorum.";
    
    // Split subtitle for typewriter effect
    var roles = subtitle.Split(new[] { ',', '&', '/' }, StringSplitOptions.RemoveEmptyEntries)
                       .Select(x => x.Trim())
                       .Where(x => !string.IsNullOrWhiteSpace(x))
                       .ToArray();
}

<!-- Banner / Hero Section -->
<div class="banner-box p-30" style="padding: 100px 60px 100px 30px; margin: 0;">
    <div class="banner-overlay"></div>
    <div class="banner-content">
        <h1 class="text-white mb-30" style="font-size: 50px; font-weight: 800; line-height: 1.2;">
            @title <br>
            <span class="text-gold typing-cursor" id="typewriter"></span>
        </h1>
        
        <p class="mb-30" style="max-width: 500px; color: var(--text-muted);">
            @desc
        </p>
        
    </div>
</div>


<div class="container-fluid">
    <div class="row">
        <div class="col-md-12">
             <div class="section-title">
                 <span>@SharedLocalizer["Services"]</span>
             </div>
             
             <div class="row" style="display: flex; gap: 20px; flex-wrap: wrap;">
                 @if (ViewBag.Services != null && Enumerable.Count(ViewBag.Services) > 0)
                 {
                     @foreach (var service in ViewBag.Services)
                     {
                         <div class="art-card" style="flex: 1; min-width: 250px;">
                             <div style="font-size: 2em; margin-bottom: 10px; color: var(--primary-color);">
                                 <i class="@service.Icon"></i>
                             </div>
                             <h5 class="mb-15" style="color: var(--text-main);">@service.Title</h5>
                             <p class="text-muted">@service.Description</p>
                         </div>
                     }
                 }
                 else
                 {
                     <!-- Default services if none in database -->
                     <div class="art-card" style="flex: 1; min-width: 250px;">
                         <div style="font-size: 2em; margin-bottom: 10px; color: var(--primary-color);"><i class="fas fa-code"></i></div>
                         <h5 class="mb-15" style="color: var(--text-main);">Veri Yok</h5>
                         <p class="text-muted">Admin panelinden hizmet ekleyebilirsiniz.</p>
                     </div>
                 }
             </div>
        </div>
    </div>
</div>

<script>
    // Simple Typewriter Effect
    const textOptions = @Html.Raw(Json.Serialize(roles));
    let textIndex = 0;
    let charIndex = 0;
    let isDeleting = false;
    const typeElement = document.getElementById('typewriter');

    function type() {
        if (!textOptions || textOptions.length === 0) return;
        
        const currentText = textOptions[textIndex];
        
        if (isDeleting) {
            typeElement.textContent = currentText.substring(0, charIndex - 1);
            charIndex--;
        } else {
            typeElement.textContent = currentText.substring(0, charIndex + 1);
            charIndex++;
        }

        let typeSpeed = 100;
        if (isDeleting) typeSpeed /= 2;

        if (!isDeleting && charIndex === currentText.length) {
            isDeleting = true;
            typeSpeed = 2000; // Pause at end
        } else if (isDeleting && charIndex === 0) {
            isDeleting = false;
            textIndex = (textIndex + 1) % textOptions.length;
            typeSpeed = 500;
        }

        setTimeout(type, typeSpeed);
    }

    document.addEventListener('DOMContentLoaded', type);
</script>
